use sev_snp::SevSnp;

fn main() {
    let sev_snp = SevSnp::new().unwrap();
    let raw_bytes = vec![
        4, 0, 0, 0, 0, 0, 0, 0, 0, 0, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 4, 0, 0, 0,
        0, 0, 25, 219, 37, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 186, 227, 67, 207, 83, 10,
        229, 47, 68, 78, 216, 156, 134, 105, 246, 152, 177, 138, 72, 243, 85, 219, 17, 37, 94, 19,
        144, 85, 162, 30, 133, 132, 26, 149, 208, 116, 86, 54, 140, 149, 188, 190, 35, 27, 67, 106,
        114, 169, 180, 200, 158, 221, 55, 95, 21, 97, 47, 171, 175, 173, 99, 133, 134, 149, 13,
        113, 77, 241, 178, 245, 98, 61, 13, 255, 175, 172, 246, 82, 206, 73, 34, 184, 144, 191,
        223, 141, 136, 179, 195, 228, 179, 221, 254, 161, 246, 211, 125, 88, 97, 137, 165, 199,
        221, 202, 141, 229, 159, 221, 86, 75, 85, 12, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 208, 31, 227, 169, 49,
        228, 40, 174, 83, 20, 31, 53, 31, 251, 36, 144, 248, 111, 141, 27, 211, 105, 37, 56, 231,
        190, 239, 205, 150, 102, 114, 3, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255,
        255, 255, 255, 4, 0, 0, 0, 0, 0, 25, 219, 25, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 18, 217, 55, 162, 224, 250, 100, 105, 41, 164, 43, 131, 175, 229,
        180, 120, 211, 152, 119, 53, 227, 132, 160, 21, 112, 126, 192, 104, 152, 225, 124, 9, 151,
        187, 135, 46, 11, 187, 114, 207, 215, 28, 80, 202, 21, 96, 118, 124, 225, 225, 152, 115,
        62, 100, 140, 14, 192, 60, 45, 103, 170, 200, 192, 185, 4, 0, 0, 0, 0, 0, 25, 219, 31, 55,
        1, 0, 31, 55, 1, 0, 4, 0, 0, 0, 0, 0, 25, 219, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 206, 156, 249, 141, 19, 4, 232, 187, 118, 212, 133, 210, 220, 74, 167, 184, 145,
        52, 103, 152, 185, 69, 29, 195, 236, 17, 81, 227, 113, 118, 170, 37, 139, 102, 36, 225, 51,
        0, 17, 58, 62, 145, 164, 80, 213, 57, 130, 69, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 223, 168, 203, 174, 105, 221, 228, 24, 124, 7, 31, 185, 23, 44,
        135, 62, 240, 160, 138, 81, 75, 97, 20, 9, 96, 80, 42, 192, 181, 24, 199, 99, 19, 124, 250,
        2, 140, 198, 236, 247, 157, 177, 91, 50, 131, 150, 92, 82, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    ];
    // println!("Attestation_bytes {:?}", raw_bytes);
    // println!("Attestation Report: {}", report);

    let rep = bincode::deserialize(&raw_bytes.clone()).unwrap();

    // Verify the attestation report
    let verified = sev_snp.verify_attestation_report(&rep, None).unwrap();

    println!("Verification successful!");
}
